<div class="inner-wrapper">
<div class="mb-30">
<button class="btn btn-lg btn-outline-primary bt-color" (click)="open(content)">+ Course Plan</button>
</div>
<ng-template #content let-c="close" let-d="dismiss">
	<div *ngIf="showModal == true">
		<form #mainCatForm="ngForm" novalidate>
			<div class="modal-header">
			    <h4 class="modal-title">Choose Category</h4>
			    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
			      <span aria-hidden="true">&times;</span>
			    </button>
			</div>
		  	<div class="modal-body" style="padding: 40px 20px;">
		    	<ul class="ul-pad">
				    <li *ngFor="let cate of courseCategories">
					    <div class="col-md-4 fl-rt">
						    <input type="radio" id="{{cate._id}}" [(ngModel)]='checked' (click)="checkedData(cate._id)" name="cate" value="{{cate.name}}">
						    <label for="{{cate._id}}" class="limit-text">	
						    	{{cate.name}}
					    	</label>
					    	<span class="checkmark"></span>
					    </div>
					</li>
				</ul>
				<!-- <div *ngIf="showLoading == true" class="loading-align">
					<img src="../assets/img/loading-spinner.gif">
				</div> -->
		  	</div>
		  	<div class="modal-footer">
		    	<button type="button" class="btn btn-light1" (click)="c('Close click')">Cancel</button>
		    	<button type="submit" class="btn btn-primary" [disabled]="!checked" (click)="selectedRadioId(checkedCatId)">Select</button>
		  	</div>
		</form>	
	</div>
	<div *ngIf="showsubModal == true"> 
		<form #subCatForm="ngForm" novalidate>
			<div class="modal-header hideFlex">
				<button type="button" class="back-modal text-info" (click)="back()">Back</button>
			    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
			      <span aria-hidden="true">&times;</span>
			    </button>
		    	<h4 class="modal-title">{{checkedName}}</h4>
			</div>
			<div class="modal-body all-box-lt">
				<div class="col-md-12 fields-mr">
					<label for="course_name">Course Name</label>
					<input class="form-control" type="text" [(ngModel)]='formField.name' name="coursename" required>
				</div>
				<div class="col-md-12 fields-mr">
					<label for="desc">Description</label>
					<textarea class="form-control" rows="4" [(ngModel)]='formField.description' name="description" required></textarea>
				</div> 
				<div class="col-md-12 fields-mr makeup-group">
					<label for="seat">Seats</label>
					<input type="number" style="width: 19%;" class="form-control" [(ngModel)]='formField.seats' min="0" name="seats" required>
				</div> 
				<div class="col-md-12 fields-mr">
					<label for="makeup_policy">MakeupPolicy</label>
					<div class="col-md-12 makeup-group">
						<div class="col-md-4">
							AllowMakeupPass<br /><input type="checkbox" [(ngModel)]='formField.makeupPolicy.allowMakeupPass' name="allowmakeup">
						</div>
						<div class="col-md-4">
							MaxDayPerPass <input type="number" class="form-control" [(ngModel)]='formField.makeupPolicy.maxDayPerPass' min="0" id="makeupass" name="makeuppass" required>
						</div>
						<div class="col-md-4">
							MaxDayPerUser <input type="number" class="form-control" [(ngModel)]="formField.makeupPolicy.maxPassPerUser" min="0" id="makeupuser" name="makeupuser" required>
						</div>
					</div>
				</div>
				<div class="col-md-12 fields-mr">
					<label for="payment_policy">PaymentPolicy</label>
					<div class="col-md-12 makeup-group">
						<div class="col-md-4">
							AllowProrated <br /><input type="checkbox" [(ngModel)]="formField.paymentPolicy.allowProrated" min="0" name="allowProrated">
						</div>
						<div class="col-md-4">
							Deposit
							<select class="form-control" name="deposit" [(ngModel)]="formField.paymentPolicy.deposit" required>
								<option></option>
								<option *ngFor="let deposit of depositLists" value="{{deposit._id}}">{{deposit.amount}}</option>
							</select>
						</div>
						<div class="col-md-4">
							CourseFee <input type="number" class="form-control" class="form-control" [(ngModel)]="formField.paymentPolicy.courseFee" min="0" name="courseFee" required>
						</div>
					</div>
					<div class="col-md-12 makeup-group">
						<div class="col-md-4">
							ProratedLessonFee <input type="number" class="form-control" [(ngModel)]="formField.paymentPolicy.proratedLessonFee" min="0" name="proratedLessonFee" required>
						</div>
						<div class="col-md-4">
							MiscFee <input type="number" class="form-control" [(ngModel)]="formField.paymentPolicy.miscFee" min="0" name="miscFee">
						</div>
					</div>
				</div>
				<div class="col-md-12 fields-mr">
					<label for="age">Age</label>
					<div class="col-md-12 makeup-group">
						<div class="col-md-4">
							From <input type="number" class="form-control" [(ngModel)]="formField.age.min" min="0" id="age" name="minage" required>
						</div>
					 	<div class="col-md-4">
					 		to <input type="number" class="form-control" [(ngModel)]="formField.age.max" min="1" id="age" name="maxage" required>
					 	</div>
					</div>
				</div>
				<div class="col-md-12 fields-mr">
					<label for="duration">Lesson</label>
					<div class="col-md-12  makeup-group">
						<div class="col-md-4">
							Min <input type="number" class="form-control" [(ngModel)]="formField.lesson.min" min="0" name="minDuration" required>
						</div> 
						<div class="col-md-4">
							Max <input type="number" class="form-control" [(ngModel)]="formField.lesson.max" min="1" name="maxDuration" required>
						</div>
						<div class="col-md-4">
							Lesson Duration <input type="number" class="form-control" [(ngModel)]='formField.lesson.duration' min="1" id="duration" name="lesson_duration" required>
						</div>	
					</div>
				</div>
				<div class="col-md-12 fields-mr">
					<label for="allowpw">Allow Pagewerkz Books</label>
					<input type="checkbox" [(ngModel)]='formField.allowPagewerkzBooks' id="allowpw" name="allowpagewerkz">
				</div>
				<div class="col-md-12">
					<label>Pdf</label>
					<div class="height-scroll">
			    		<div *ngFor="let pdf of pdfList; let i = index" style="float: left; margin-right: 15px;">
				    		<input type="checkbox" id="{{pdf._id}}" value="{{pdf._id}}" (click)="ChangeValue($event)" name="pdf" [checked]="pdf.checked">
				    		<label for="{{pdf._id}}"> {{pdf.name}}</label>
				    	</div>
			    	</div>
					<!-- <select style="width: 19%;" class="form-control" name="pdf" [(ngModel)]="formField.quizwerkz" required multiple>
						<option *ngFor="let pdf of pdfList; let i = index" value="{{pdf._id}}">{{pdf.name}}</option>
					</select> -->					
				</div>
				<div class="col-md-12 fields-mr">
					<label>Holiday</label>
					<select style="width: 19%;" class="form-control" name="holidayCalendar" [(ngModel)]="formField.holidayCalendarId" required>
						<option></option>
						<option *ngFor="let holidayCalendar of holidayCalendarLists" value="{{holidayCalendar._id}}">{{holidayCalendar.name}}</option>
					</select>					
				</div>
			</div>
			<div class="modal-footer">
		    	<button type="button" class="btn btn-light1" (click)="c('Close click')">Cancel</button>
		    	<div [hidden]="!createButton">
		    		<button type="submit" class="btn btn-primary" [disabled]="!subCatForm.valid" (click)="createdPlan(subCatForm.value)">Create</button>
		    	</div>
		    	<div [hidden]="!updateButton">
		    		<button type="submit" class="btn btn-primary" [disabled]="!subCatForm.valid" (click)="updatedPlan(subCatForm.value)">Update</button>
		    	</div>
		  	</div>
		</form>		
	</div>
</ng-template>
<block-ui message="Deafult Message"></block-ui>

<div class="overflow">
	<ul class="list-group-flush">  
	  <li id="{{courseplan._id}}" class="list-group-item" *ngFor="let courseplan of courseplanLists; let i = index" [attr.data-index]="i">
		{{i + 1}}-{{ courseplan.name }} 		
		<button type="button" class="btn btn-secondary float-right btn-sm margin-left" (click)="onclickDelete(courseplan,confirmDelete1)">Delete</button>
		<button type="button" style="margin-right: 10px;" class="btn btn-secondary float-right btn-sm margin-left" (click)="editcPlan(content, courseplan._id)">Edit</button>
		<button type="button" style="margin-right: 10px;" class="btn btn-secondary float-right btn-sm margin-left" (click)="viewPlan(view, courseplan._id)">View</button>
	  </li>
	</ul>
</div>

<ng-template #view let-c="close" let-d="dismiss">
  <div class="modal-header">
  	<h4 class="modal-title">Course Plan View</h4>
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body view" *ngIf="viewCplan">
  	<div><label>Category Name:</label> <span>{{checkedName}}</span></div>
    <div><label>Course Name:</label> <span>{{viewCplan.name}}</span> </div>
    <div><label>Description:</label> <span>{{viewCplan.description}}</span></div>
    <div><label>Seats:</label> <span>{{viewCplan.seats}}</span></div>
    <div><label>MakeupPolicy</label> 
    	<div>
    		<span>AllowMakeupPass: {{viewCplan.makeupPolicy.allowMakeupPass}}</span>
    	</div>
    	<div>
    		<span>MaxDayPerPass: {{viewCplan.makeupPolicy.maxPassPerPass}}</span>
    	</div>
    	<div>
    		<span>MaxDayPerUser: {{viewCplan.makeupPolicy.maxPassPerUser}}</span>
    	</div>
    </div>
    <div><label>PaymentPolicy</label> 
    	<div>
    		<span>AllowProrated: {{viewCplan.paymentPolicy.allowProrated}}</span>
    	</div>
    	<div>
    		<span>Deposit: {{depositName}}</span>
    	</div>
    	<div>
    		<span>CourseFee: {{viewCplan.paymentPolicy.courseFee}}</span>
    	</div>
    	<div>
    		<span>ProratedLessonFee: {{viewCplan.makeupPolicy.proratedLessonFee}}</span>
    	</div>
    	<div>
    		<span>MiscFee: {{viewCplan.makeupPolicy.miscFee}}</span>
    	</div>
    </div>
    <div><label>Age</label>
    	<div><span>From: {{viewCplan.age.min}}</span></div>
    	<div><span>To: {{viewCplan.age.max}}</span></div>
    </div>
    <div><label>Lesson</label>
    	<div><span>Min: {{viewCplan.lesson.min}}</span></div>
    	<div><span>Max: {{viewCplan.lesson.max}}</span></div>
    	<div><span>Duration: {{viewCplan.lesson.duration}}</span></div>
    </div>
    <div>
    	<label>AllowPagewerkzBooks:</label> <span>{{viewCplan.allowPagewerkzBooks}}</span>
    </div>
    <div>
    	<label>Pdf:</label> <span>{{pdfName}}</span>
    </div>
    <div>
    	<label>Holiday:</label> <span>{{holidayCalendarName}}</span>
    </div>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-light1" (click)="c('Close click')">Cancel</button>
  </div>
</ng-template>

<ng-template #confirmDelete1 let-c="close" let-d="dismiss">
  <div class="modal-header">
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body" style="min-height: 100px;">
    <h4>Are You sure you want to delete?</h4>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-light1" (click)="c('Close click')">Cancel</button>
    <button type="submit" class="btn btn-danger" (click)="confirmDelete(selectcPlan,confirmDelete2)">Delete</button>
  </div>
</ng-template>

<ng-template #confirmDelete2 let-c="close" let-d="dismiss">
  <div class="modal-header">
    <button type="button" class="close" aria-label="Close" (click)="d('Cross click')">
      <span aria-hidden="true">&times;</span>
    </button>
  </div>
  <div class="modal-body" style="min-height: 100px;">
    <h4>We are going to delete <span style="color: red;">"{{selectcPlan.name}}"</span></h4>
  </div>
  <div class="modal-footer">
    <button type="button" class="btn btn-light1" (click)="c('Close click')">Cancel</button>
    <button type="submit" class="btn btn-danger" (click)="deleteCoursePlan(selectcPlan._id)">Confirm</button>
  </div>
</ng-template>
</div>
