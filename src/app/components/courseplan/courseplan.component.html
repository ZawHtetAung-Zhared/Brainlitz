<div *ngIf="goBackCat" (scroll)="onScroll($event)">
  <div class="inner-wrapper">
    <header>
      <div
        class="d-flex d-wrapper"
        [ngClass]="{ stickywrap: navIsFixed == true }"
      >
        <div class="mr-auto p-2 pl-0 pb-0">
          <div class="back-modal" (click)="back()">
            <i class="fa fa-angle-left"></i>
            <p>Pick Category</p>
          </div>
        </div>
        <div class="p-2">
          <div class="d-flex flex-row courseplan-info">
            <p>#{{ checkedName }}</p>
            <span class="sticky-dot">&#183;</span>
            <h5>Course plan</h5>
          </div>
        </div>
        <div class="ml-auto">
          <button type="button" class="btn sticky-cancel" (click)="cancel()">
            Cancel
          </button>
        </div>
      </div>
    </header>
  </div>
  <form #parentForm="ngForm" novalidate>
    <div class="sticky-menu" [ngClass]="{ sticky: navIsFixed == true }">
      <div class="d-flex">
        <div class="mr-auto p-2 pl-0 pb-0">
          <div class="back-modal" (click)="back()">
            <i class="fa fa-angle-left"></i>
            <p>Pick Category</p>
          </div>
        </div>
        <div class="p-2">
          <div class="d-flex flex-row courseplan-info">
            <p>#{{ checkedName }}</p>
            <span class="sticky-dot">&#183;</span>
            <h5>Course plan</h5>
          </div>
        </div>
        <div class="ml-auto">
          <button type="button" class="btn sticky-cancel" (click)="cancel()">
            Cancel
          </button>
        </div>
      </div>
    </div>
    <div class="progress-box-wrap">
      <!-- {{clickableSteps|json}} -->
      <ol class="progress" data-steps="8">
        <li id="step1">
          <a
            class="step"
            [class.adisabled]="!clickableSteps.includes('step1')"
            (click)="stepClick($event, 'step1')"
          >
            <span>1</span>
          </a>
        </li>
        <li id="step2">
          <a
            class="step"
            [class.adisabled]="!clickableSteps.includes('step2')"
            (click)="stepClick($event, 'step2')"
          >
            <span>2</span>
          </a>
        </li>
        <li id="step3">
          <a
            class="step"
            [class.adisabled]="!clickableSteps.includes('step3')"
            (click)="stepClick($event, 'step3')"
          >
            <span>3</span>
          </a>
        </li>
        <li id="step4">
          <a
            class="step"
            [class.adisabled]="!clickableSteps.includes('step4')"
            (click)="stepClick($event, 'step4')"
          >
            <span>4</span>
          </a>
        </li>
        <li id="step5">
          <a
            class="step"
            [class.adisabled]="!clickableSteps.includes('step5')"
            (click)="stepClick($event, 'step5')"
          >
            <span>5</span>
          </a>
        </li>
        <li id="step6">
          <a
            class="step"
            [class.adisabled]="!clickableSteps.includes('step6')"
            (click)="stepClick($event, 'step6')"
          >
            <span>6</span>
          </a>
        </li>
        <li id="step7">
          <a
            class="step"
            [class.adisabled]="!clickableSteps.includes('step7')"
            (click)="stepClick($event, 'step7')"
          >
            <span>7</span>
          </a>
        </li>
        <li id="step8">
          <a
            class="step"
            [class.adisabled]="!clickableSteps.includes('step8')"
            (click)="stepClick($event, 'step8')"
          >
            <span>8</span>
          </a>
        </li>
      </ol>
    </div>
    <div *ngIf="step1" class="div_step1">
      <div class="d-flex justify-content-center">
        <form class="form-wrap" #childForm1="ngForm" novalidate>
          <div class="inside-data-wrapper">
            <div class="overlay-wrapper">
              <div class="col-md-12">
                <p class="step-font">Step 1</p>
                <h5 class="all-title-font text-font-align">Plan information</h5>
              </div>
              <div class="display-style">
                <div class="col-md-6">
                  <div>
                    <div class="d-flex justify-content-between">
                      <label for="course_name" class="all-title-font"
                        >Plan name</label
                      >
                      <div class="limit-wordcount">
                        <span>{{ wordLength }}/60characters</span>
                      </div>
                    </div>
                    <input
                      class="form-control br-bshadow-none all-left-box-10"
                      type="text"
                      [(ngModel)]="formField.name"
                      (focus)="focusMethod($event, 'name', $event.target.value)"
                      (blur)="blurMethod($event, 'name')"
                      maxlength="60"
                      (input)="changeMethod($event.target.value)"
                      name="coursename"
                      placeholder="Type plan name here"
                      autocomplete="off"
                      #cpName="ngModel"
                      required
                    />
                    <div
                      *ngIf="cpName.invalid && (cpName.dirty || cpName.touched)"
                      class="alert alert-danger alert-m-right"
                    >
                      <div [hidden]="!cpName.errors.required">
                        Course plan name is required!
                      </div>
                    </div>
                    <hr class="limit-hr-length" />
                  </div>
                  <div class="mr-top">
                    <label for="seat" class="all-title-font">Seats</label>
                    <input
                      type="number"
                      placeholder="0"
                      class="form-control br-bshadow-none all-left-box-10"
                      (keypress)="numberOnly($event, 'seats')"
                      [(ngModel)]="formField.seats"
                      min="0"
                      name="seats"
                      #cpSeat="ngModel"
                    />
                    <!-- <div *ngIf="cpSeat.invalid && (cpSeat.dirty || cpSeat.touched)" class="alert alert-danger alert-m-right">
													<div [hidden]="!cpSeat.errors.required">
													  Number of seates is required!
													</div>
												</div> -->
                    <hr class="limit-hr-length" />
                  </div>
                </div>
                <div class="col-md-6">
                  <div>
                    <div class="d-flex justify-content-between">
                      <label
                        style="padding-left: 10px;"
                        for="desc"
                        class="all-title-font"
                        >Description</label
                      >
                      <div class="limit-wordcount1">
                        <span>{{ wordLength }}/280characters</span>
                      </div>
                    </div>
                    <textarea
                      class="form-control br-bshadow-none"
                      rows="5"
                      [(ngModel)]="formField.description"
                      (focus)="focusMethod($event, 'msg', $event.target.value)"
                      (blur)="blurMethod($event, 'msg')"
                      maxlength="280"
                      (input)="changeMethod($event.target.value)"
                      name="description"
                      #cpDesc="ngModel"
                      placeholder="Type message here"
                    ></textarea>
                    <!-- <div *ngIf="cpDesc.invalid && (cpDesc.dirty || cpDesc.touched)" class="alert alert-danger">
													<div [hidden]="!cpDesc.errors.required">
													  Description is required!
													</div>
												</div> -->
                    <hr class="limit-hr-length" />
                  </div>
                </div>
              </div>
            </div>
            <div class="button-wrapper">
              <button
                type="button"
                class="btn sticky-create"
                [disabled]="!childForm1.valid"
                (click)="continueStep('step1', childForm1.value)"
              >
                Continue
              </button>
              <button
                type="button"
                [hidden]="step1"
                class="back-btn"
                (click)="backStep()"
              >
                <i class="fa fa-angle-left"></i> Back
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div *ngIf="step2" class="div_step2">
      <div class="d-flex justify-content-center">
        <form class="form-wrap" #childForm2="ngForm" novalidate>
          <div class="inside-data-wrapper">
            <div class="col-md-12 overlay-wrapper">
              <p class="step-font">Step 2</p>
              <div class="step_height">
                <div class="display-style">
                  <h5 class="all-title-font title-br-rt">Makeup policy</h5>
                  <div class="radio-pos">
                    <label class="switch">
                      <input
                        type="checkbox"
                        [(ngModel)]="formField.makeupPolicy.allowMakeupPass"
                        name="allowmakeup"
                        #makeupcheck="ngModel"
                      />
                      <span
                        class="slider round"
                        [ngClass]="{
                          activeRadio:
                            formField.makeupPolicy.allowMakeupPass == true
                        }"
                      ></span>
                    </label>
                  </div>
                </div>
                <p class="input-recommend">
                  If you allow your students to catch up with their missed
                  classes, Turn On the “Makeup Policy” option.
                </p>
                <div *ngIf="formField.makeupPolicy.allowMakeupPass != true">
                  <p class="option-text">
                    Switch <span>on</span><br />to add Makeup class.
                  </p>
                </div>
                <div *ngIf="formField.makeupPolicy.allowMakeupPass == true">
                  <div class="display-style">
                    <div class="col-md-6" style="padding: 0;">
                      <div>
                        <label class="all-title-font">
                          Validation duration after class
                        </label>
                        <input
                          type="number"
                          class="form-control all-left-box-10 br-bshadow-none"
                          (keypress)="numberOnly($event, 'makeupDuration')"
                          [(ngModel)]="formField.makeupPolicy.maxDayPerPass"
                          min="0"
                          id="makeupass"
                          name="makeuppass"
                          #makeuppass="ngModel"
                          placeholder="0 day"
                        />
                        <!-- <div *ngIf="makeuppass.invalid && (makeuppass.dirty || makeuppass.touched)" class="alert alert-danger alert-m-right">
													<div [hidden]="!makeuppass.errors.required">
														Validation duration after class is required!
													</div>
												</div> -->
                        <hr class="limit-hr-length" />
                      </div>
                    </div>
                    <div class="col-md-6" style="padding-right: 0;">
                      <div>
                        <label
                          class="all-title-font"
                          style="padding-left: 20px;"
                        >
                          Number of days per user
                        </label>
                        <input
                          type="number"
                          class="form-control br-bshadow-none all-m-left10"
                          (keypress)="numberOnly($event, 'makeupUser')"
                          [(ngModel)]="formField.makeupPolicy.maxPassPerUser"
                          min="0"
                          id="makeupuser"
                          name="makeupuser"
                          placeholder="0 day"
                          #makeupuser="ngModel"
                        />
                        <!-- <div *ngIf="makeupuser.invalid && (makeupuser.dirty || makeupuser.touched)" class="alert alert-danger alert-m-left">
													<div [hidden]="!makeupuser.errors.required">
														Number of days per user is required!
													</div>
												</div> -->
                        <hr class="limit-hr-length all-m-left10" />
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="button-wrapper">
              <div
                [hidden]="!step2"
                class="back-modal"
                (click)="backStep('step2')"
              >
                <i class="fa fa-angle-left"></i>
                <p>Back</p>
              </div>
              <button
                type="button"
                class="btn sticky-create"
                [disabled]="!childForm2.valid"
                (click)="continueStep('step2', childForm2.value)"
              >
                Continue
              </button>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div *ngIf="step3" class="div_step3">
      <div class="d-flex justify-content-center">
        <form class="form-wrap" #childForm3="ngForm" novalidate>
          <div class="inside-data-wrapper">
            <div class="overlay-wrapper">
              <div class="col-md-12">
                <p class="step-font">Step 3</p>
                <h5 class="all-title-font text-font-align">Payment policy</h5>
              </div>
              <div class="step_height">
                <label
                  class="cfOpt-title"
                  style="padding-left: 15px; padding-top: 40px"
                >
                  Course fee options</label
                >
                <div
                  *ngFor="let opt of optArray; let idx = index"
                  class="d-flex"
                  style="width: 60%;"
                >
                  <div>
                    <div
                      [ngClass]="{ 'shadow-bg': shadowIdx == idx }"
                      (mouseenter)="mouseEnter(idx)"
                      (mouseleave)="mouseLeave(idx)"
                      class="d-flex  optInput-wrap"
                    >
                      <input
                        type="text"
                        name="{{ 'name' + idx }}"
                        class="form-control col-md-8 taxopt-input feeName-input"
                        [ngClass]="{ 'shadow-bg': shadowIdx == idx }"
                        placeholder="Type option name"
                        [value]="opt.name"
                        (input)="this.optArray[idx].name = $event.target.value"
                      />
                      <div class="d-flex col-md-4 p-0 cfee-wrap">
                        <div
                          class="currencySign"
                          [ngStyle]="{
                            background: shadowIdx == idx ? '#8fa1b3' : '#f2f4f5'
                          }"
                        >
                          {{ currency.invCurrencySign }}
                        </div>
                        <input
                          type="number"
                          [value]="opt.fees"
                          (input)="inputOpt(idx, $event.target.value)"
                          class="form-control taxopt-input c-fee"
                          placeholder="Course fee"
                          (keypress)="numberOnly($event, 'feeOpt')"
                          name="{{ 'fee' + idx }}"
                        />
                      </div>
                    </div>
                    <hr class="opt-hr-length" />
                  </div>
                  <div *ngIf="optArray?.length > 1" class="removeBtn-wrap">
                    <div class="removeIcon-shadow">
                      <div
                        class="removeIcon"
                        (click)="removeFeeOption(idx)"
                      ></div>
                    </div>
                  </div>
                </div>
                <button class="addOpt-btn" (click)="addFeeOption()">
                  Add new option
                </button>
              </div>
            </div>
            <div class="button-wrapper">
              <button
                type="button"
                class="btn sticky-create"
                [disabled]="!childForm3.valid"
                (click)="continueStep('step3', childForm3.value)"
              >
                Continue
              </button>
              <div
                [hidden]="!step3"
                class="back-modal"
                (click)="backStep('step3')"
              >
                <i class="fa fa-angle-left"></i>
                <p>Back</p>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div *ngIf="step4" class="div_step4">
      <div class="d-flex justify-content-center">
        <form class="form-wrap" #childForm4="ngForm" novalidate>
          <div class="inside-data-wrapper">
            <div class="overlay-wrapper">
              <div class="col-md-12">
                <p class="step-font">Step 4</p>
                <h5 class="all-title-font text-font-align">Lesson</h5>
                <p class="input-recommend">
                  Choose a calendar from here to set holidays. If you do not
                  find a relevant calendar, go to Tools > Calendar and create a
                  new one.
                </p>
              </div>
              <div class="display-style" style="padding-top: 40px;">
                <div class="col-md-6">
                  <label class="all-title-font"> Duration</label>
                  <input
                    type="text"
                    placeholder="{{ formField.lesson.duration }}"
                    class="form-control br-bshadow-none hoverReadonly all-left-box-10"
                    [(ngModel)]="formField.lesson.duration"
                    min="1"
                    id="duration"
                    name="lesson_duration"
                    readonly
                    (click)="durationProgress($event)"
                    style="background: none;"
                  />
                  <div class="bg-box duration-progress">
                    <div id="rectangle"></div>
                    <div class="gap-box">
                      <label>
                        <div class="col-md-4 max-range">{{ rangeHr }} hr</div>
                        <input
                          class="max-range-box"
                          type="range"
                          id="hrDuration"
                          name="pointsHr"
                          min="0"
                          max="24"
                          (input)="ChangedRangeValue($event.target.value, 'hr')"
                          [(ngModel)]="rangeHr"
                        />
                      </label>
                    </div>
                    <div class="gap-range-min">
                      <label>
                        <div class="col-md-4 min-range">{{ rangeMin }} min</div>
                        <input
                          class="min-range-box"
                          type="range"
                          id="minDuration"
                          name="pointsMin"
                          min="0"
                          max="55"
                          step="5"
                          (input)="
                            ChangedRangeValue($event.target.value, 'min')
                          "
                          [(ngModel)]="rangeMin"
                          [disabled]="overDurationHr"
                        />
                        <p *ngIf="overDurationHr" class="alert-duration">
                          Lesson Duration has only 24 hr, so can not choose
                          minute.
                        </p>
                      </label>
                    </div>
                  </div>
                  <hr class="limit-hr-length" />
                </div>
                <!-- <div class="col-md-6" style="padding-right: 0;">
									<div>
										<label class="all-title-font" style="padding-left: 10px;">Holiday Calendar</label>
										<select class="form-control br-bshadow-none" name="holidayCalendar" [(ngModel)]="formField.holidayCalendarId" style="font-size: 16px; height: auto;">
											<option disabled="true" [value]="'disabledHoliday'">None</option>
											<option *ngFor="let holidayCalendar of holidayCalendarLists" [value]="holidayCalendar._id">{{holidayCalendar.name}}</option>
										</select>	
										 <i class="fa fa-chevron-down down-arrow2"></i>	
										 <hr class="limit-hr-length">	
									</div> 		
								</div> -->
                <div class="col-md-6" style="padding-right: 0;">
                  <div>
                    <label class="all-title-font" style="padding-left: 10px;"
                      >Holiday Calendar</label
                    >
                    <div>
                      <div
                        class="form-group has-feedback"
                        (click)="holidayDropdown()"
                      >
                        <input
                          class="cursor-on form-control br-bshadow-none"
                          name="holiday"
                          readonly
                          type="text"
                          [(ngModel)]="formField.holidayCalendarName"
                          placeholder="None"
                          autocomplete="off"
                        /><span
                          class="fa fa-angle-down holiday-downicon"
                        ></span>
                      </div>
                      <div class="dropdown-wrap">
                        <!-- <div *ngIf="locationMenuShow == false" class="carret"></div> -->
                        <ul class="holiday-dropdown">
                          <li
                            *ngFor="let holidayCalendar of holidayCalendarLists"
                            (click)="chooseHoliday(holidayCalendar)"
                          >
                            <span>{{ holidayCalendar.name }}</span>
                          </li>
                        </ul>
                      </div>
                    </div>
                  </div>
                  <hr class="limit-hr-length" />
                </div>
              </div>
            </div>
            <div class="button-wrapper">
              <button
                type="button"
                class="btn sticky-create"
                [disabled]="
                  formField.lesson.duration == undefined ||
                  formField.lesson.duration == 0 ||
                  formField.lesson.duration == '0 min'
                "
                (click)="continueStep('step4', childForm4.value)"
              >
                Continue
              </button>
              <div
                [hidden]="!step4"
                class="back-modal"
                (click)="backStep('step4')"
              >
                <i class="fa fa-angle-left"></i>
                <p>Back</p>
              </div>
            </div>
          </div>
        </form>
      </div>
    </div>
    <div *ngIf="step5" class="div_step5">
      <div class="d-flex justify-content-center">
        <form #childForm5="ngForm" class="form-wrap" novalidate>
          <div class="inside-data-wrapper">
            <div class="overlay-wrapper">
              <div class="col-md-12">
                <p class="step-font">Step 5</p>

                <div class="display-style">
                  <h5 class="all-title-font title-br-rt">QuizWerkz Book</h5>
                  <div class="radio-pos-book">
                    <label class="switch">
                      <input
                        type="checkbox"
                        [(ngModel)]="formField.allowPagewerkz"
                        id="allowpw"
                        name="allowpagewerkz"
                      />
                      <span
                        class="slider round"
                        [ngClass]="{
                          activeRadio: formField.allowPagewerkz == true
                        }"
                      ></span>
                    </label>
                  </div>
                </div>
                <p class="input-recommend">
                  Select your books / resources for this Course Plan. If you do
                  not see the required book here, go to Tools > ‘Create
                  Quizwerkz’.
                </p>
                <div
                  *ngIf="formField.allowPagewerkz != true"
                  class="not_allowPagewekz"
                >
                  <p class="option-text">
                    Switch <span>on</span><br />to add QuizWerkz book.
                  </p>
                </div>
              </div>
              <div
                class="col-md-12"
                *ngIf="formField.allowPagewerkz == true"
                class="allowPagewekz"
              >
                <drag-scroll class="drag-wrapper">
                  <div
                    *ngFor="let pdf of pdfList; let i = index"
                    class="book-range"
                  >
                    <label
                      for="{{ pdf._id }}"
                      class="book-label"
                      [ngClass]="{
                        'drag-active-bg': pdfId.indexOf(pdf._id) != -1
                      }"
                    >
                      <img
                        drag-scroll-item
                        src="{{ pdf.cover }}"
                        width="125"
                        height="180"
                        style="margin-bottom: 10px;"
                      />
                      <input
                        type="checkbox"
                        id="{{ pdf._id }}"
                        value="{{ pdf._id }}"
                        (click)="ChangeValue(pdf._id, $event, 'pdf')"
                        name="pdf"
                        [checked]="pdfId.indexOf(pdf._id) != -1"
                      />
                      <div class="book-name">{{ pdf.name }}</div>
                    </label>
                  </div>
                </drag-scroll>
              </div>
            </div>
            <div class="button-wrapper">
              <!-- <button type="button" class="btn sticky-create" [disabled]="pdfId?.length == 0 || formField.allowPagewerkz != true" (click)="continueStep('step5', childForm5.value)">Continue</button> -->
              <button
                type="button"
                class="btn sticky-create"
                (click)="continueStep('step5', childForm5.value)"
              >
                Continue
              </button>
              <div
                [hidden]="!step5"
                class="back-modal"
                (click)="backStep('step5')"
              >
                <i class="fa fa-angle-left"></i>
                <p>Back</p>
              </div>
              <span class="show-count">{{ pdfId.length }} books picked</span>
            </div>
          </div>
          <!-- <hr class="limit-hr-100 mr-top-20"> -->
        </form>
      </div>
    </div>
    <div *ngIf="step6" class="div_step6">
      <div class="d-flex justify-content-center">
        <form #childForm6="ngForm" novalidate class="step6-form">
          <div *ngIf="showSearchAPG" class="inside-data-wrapper">
            <div class="overlay-wrapper">
              <div class="col-md-12">
                <p class="step-font">Step 6</p>
                <div class="d-flex">
                  <h3 class="all-title-font" style="float: left;">APG</h3>
                  <span class="sticky-dot-large">&#183;</span>
                  <p class="small-caption">Access Point Group</p>
                </div>
              </div>
              <div class="col-md-12">
                <p class="input-recommend">
                  APG or Access Point Group is where a Teacher will be able to
                  mark the progress or improvement of each student. It can be in
                  the form of Progress Bar or Badges. This will be notified to
                  the Parent or Student whose email ID is registered. Begin by
                  clicking on the Search icon.
                </p>
              </div>
              <div
                class="custom-dropdown-width input-group col-md-12 all-title-font"
              >
                <div class="input-group w-100">
                  <input
                    class="form-control py-2 input-search-bg"
                    type="search"
                    placeholder="Search APG"
                    id="search-apg"
                    name="searchApg"
                    [(ngModel)]="formField.searchText"
                    (focus)="focusSearch($event, 'apg')"
                    (focusout)="hideSearch($event, 'apg')"
                    (input)="changeSearch($event.target.value, 'apg')"
                    autocomplete="off"
                  />
                  <span class="input-group-append">
                    <button
                      class="bt btn-design btn-outline-secondary"
                      type="button"
                    >
                      <i class="fa fa-search search-size"></i>
                    </button>
                  </span>
                </div>
                <div>
                  <div class="search-result-box" *ngIf="isfocus == true">
                    <div
                      class="single-result"
                      (click)="selectData(apg._id, apg.name)"
                      *ngFor="let apg of apgList"
                    >
                      <div class="d-flex">
                        <div class="circle1 plus"></div>
                        <div>
                          <div>{{ apg.name }}</div>
                          <div class="step-font font-12" *ngIf="apg.module">
                            {{ apg.module.name }}
                          </div>
                          <div class="step-font font-12" *ngIf="!apg.module">
                            -
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                  <!-- <div *ngIf="showfixedcreate == true" class="fixedText">
										<div class="top-line">
											<button type="button" class="bt btn-apg" (click)="goToModule()">
												<div class="circle3 plus"></div>Create new APG
											</button>
										</div>
									</div> -->
                </div>

                <!-- <div *ngIf="showfixedcreate == true" class="fixedText">
									<div class="top-line">
										<button type="button" class="bt btn-apg" (click)="goToModule()">
											<div class="circle3 plus"></div>Create new APG
										</button>
									</div>
								</div> -->
              </div>
              <div
                class="col-md-12 pl-zero"
                *ngIf="showfixedcreate == true"
              ></div>
              <div
                [hidden]="createdAPGstore?.length > 0 || showfixedcreate"
                class="display-style col-md-12"
                style="margin-top: 30px;"
              >
                <div class="col-md-6 img-pos">
                  <img src="assets/img/apg-list-default.png" />
                </div>
                <div class="col-md-6">
                  <div class="txt-default">
                    <h3>Add APG to this Course Plan</h3>
                  </div>
                  <div class="arrow-pos">
                    <img src="assets/img/arrow.png" />
                  </div>
                </div>
              </div>
              <div *ngIf="selectedAPGlists == true" class="col-md-12 pl-zero">
                <div class="wrap-height">
                  <div *ngFor="let cAPG of createdAPGstore">
                    <div class="group-text">
                      <!-- {{cAPG|json}} -->
                      <button
                        type="button"
                        class="bt btn-apg"
                        (click)="removeSelectedAPG(cAPG)"
                      >
                        <div class="circle2 minus"></div>
                        <div class="all-title-font">{{ cAPG.name }}</div>
                        <div
                          style="padding-left: 35px; padding-bottom: 15px; color: #64707d; font-family: Inter-UI-SemiBold; font-size: 12px;"
                        >
                          {{ cAPG.type }}
                        </div>
                      </button>
                    </div>
                    <hr class="hr-style" />
                  </div>
                </div>
              </div>
            </div>
            <div *ngIf="!showModule && !createAPGform">
              <!-- <hr> -->
              <div class="button-wrapper">
                <button
                  type="button"
                  class="btn sticky-create"
                  (click)="continueStep('step6', createdAPGstore)"
                >
                  Continue
                </button>
                <div
                  [hidden]="!step6"
                  class="back-modal"
                  (click)="backStep('step6')"
                >
                  <i class="fa fa-angle-left"></i>
                  <p>Back</p>
                </div>
              </div>
            </div>
          </div>

          <div *ngIf="showModule" class="inside-data-wrapper">
            <div class="col-md-12">
              <p class="back" (click)="backSearhAPG('back')">
                <i class="fa fa-angle-left left-arrow"></i><span>APG</span>
              </p>
              <h3 class="all-title-font">Pick APG type</h3>
            </div>
            <div class="row pad-15">
              <div
                *ngFor="let module of moduleList; let i = index"
                class="module-input col-xs-12 col-sm-4 col-md-4 col-lg-4 col-xxl"
                [ngClass]="{ 'disable-click': module.name == 'Badge' }"
              >
                <label
                  class="form-check-label"
                  [ngClass]="{ selected: ischecked == module._id }"
                >
                  <div class="module-img">
                    <img
                      *ngIf="ischecked != module._id"
                      class="setting-icon"
                      src="./assets/icons/{{
                        module.name.toLowerCase() == 'assessment'
                          ? 'evaluation'
                          : module.name.toLowerCase()
                      }}-type.png"
                      class="img-fluid"
                    />
                    <img
                      *ngIf="ischecked == module._id"
                      class="setting-icon"
                      src="./assets/icons/{{
                        module.name.toLowerCase() == 'assessment'
                          ? 'evaluation'
                          : module.name.toLowerCase()
                      }}-type-a.png"
                      class="img-fluid"
                    />
                  </div>
                  <div class="label-checked"></div>
                  <input
                    class="form-check-input"
                    type="radio"
                    name="inlineRadioOptions"
                    id="module._id"
                    value="{{ module.name }}"
                    (click)="chooseModuleType(module._id, module.name)"
                  />
                  {{ module.name }}
                </label>
              </div>
            </div>
          </div>
          <div *ngIf="createAPGform">
            <form class="form-wrap" #apgCreateForm="ngForm" novalidate>
              <div class="inside-data-wrapper">
                <div class="col-md-12">
                  <p class="back" (click)="backModule()">
                    <i class="fa fa-angle-left left-arrow"></i
                    ><span>Pick APG type</span>
                  </p>
                  <h3 class="all-title-font">Create APG</h3>
                </div>
                <div class="col-md-6" style="padding-top: 40px;">
                  <!-- <p>APG name <br><span>We recommend to set APG name as same as Course name.</span></p> -->
                  <div class="d-flex justify-content-between">
                    <label
                      class="form-title input-label all-title-font"
                      for="address"
                      >APG name</label
                    >
                    <div class="limit-wordcount">
                      <span class="count-color"
                        >{{ wordLength }}/60characters</span
                      >
                    </div>
                  </div>
                  <p class="input-recommend">
                    We recommend to set APG name as same as Course name.
                  </p>
                  <input
                    class="form-control br-bshadow-none all-left-box-10"
                    type="text"
                    [(ngModel)]="formAPG.name"
                    name="name"
                    placeholder="Name"
                    maxlength="60"
                    [(ngModel)]="model.name"
                    (focus)="focusMethod($event, 'name', $event.target.value)"
                    (blur)="blurMethod($event, 'name')"
                    (input)="changeMethod($event.target.value)"
                    #apgName="ngModel"
                    required
                  />
                  <div
                    *ngIf="
                      apgName.invalid && (apgName.dirty || apgName.touched)
                    "
                    class="alert alert-danger alert-m-right"
                  >
                    <div [hidden]="!apgName.errors.required">
                      APG name is required!
                    </div>
                  </div>
                  <hr class="limit-hr-length" />
                  <div class="d-flex justify-content-between">
                    <label
                      class="form-title input-label all-title-font"
                      for="address"
                      >Description</label
                    >
                    <div class="limit-wordcount1">
                      <span class="count-color"
                        >{{ wordLength }}/280characters</span
                      >
                    </div>
                  </div>
                  <textarea
                    class="form-control br-bshadow-none all-left-box-10"
                    rows="5"
                    style="margin-bottom: 15px;"
                    [(ngModel)]="formAPG.description"
                    name="description"
                    (focus)="focusMethod($event, 'msg', $event.target.value)"
                    (blur)="blurMethod($event, 'msg')"
                    (input)="changeMethod($event.target.value)"
                    maxlength="280"
                    #apgDesc="ngModel"
                    placeholder="Type description here"
                  ></textarea>
                  <!-- <div *ngIf="apgDesc.invalid && (apgDesc.dirty || apgDesc.touched)" class="alert alert-danger alert-m-right">
										<div [hidden]="!apgDesc.errors.required">
											APG description is required!
										</div>
									</div>	 -->
                  <hr class="limit-hr-length" />
                </div>
                <div class="d-flex justify-content-end button-wrapper">
                  <button
                    type="button"
                    class="bt cancel-button"
                    (click)="backSearhAPG('cancel')"
                  >
                    Cancel
                  </button>
                  <button
                    type="submit"
                    (click)="createAPGs(apgCreateForm.value)"
                    [disabled]="!apgCreateForm.valid"
                    class="btn create-button"
                  >
                    Create
                  </button>
                </div>
              </div>
            </form>
          </div>
        </form>
      </div>
    </div>
    <div *ngIf="step7" class="div_step7">
      <div class="d-flex justify-content-center">
        <div class="inside-data-wrapper pad-100">
          <div class="overlay-wrapper">
            <div class="col-md-12">
              <p class="step-font">Step 7</p>
              <h3 class="all-title-font">Assessment Plan</h3>
            </div>
            <div
              class="custom-dropdown-width input-group col-md-12 all-title-font"
            >
              <div class="input-group w-100">
                <input
                  class="form-control py-2 input-search-bg"
                  type="search"
                  placeholder="Search Assessment Plan"
                  id="search-apg"
                  name="searchPlan"
                  [(ngModel)]="formField.searchText"
                  (focus)="focusSearch($event, 'plan')"
                  (focusout)="hideSearch($event, 'plan')"
                  (input)="changeSearch($event.target.value, 'plan')"
                  autocomplete="off"
                />
                <span class="input-group-append">
                  <button
                    class="bt btn-design btn-outline-secondary"
                    type="button"
                  >
                    <i class="fa fa-search search-size"></i>
                  </button>
                </span>
              </div>
              <div *ngIf="showPlans">
                <div class="search-result-box">
                  <div
                    *ngFor="let plan of assessmentPlans"
                    (click)="selectAssessmentPlan(plan)"
                  >
                    <div
                      class="single-result"
                      [ngClass]="{
                        'hide-plan': selectedAPidList.indexOf(plan._id) > -1
                      }"
                    >
                      <div class="d-flex">
                        <div class="circle1 plus"></div>
                        <div>
                          <div>{{ plan.name }}</div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div
                *ngIf="!showPlans && selectedAPlans?.length > 0"
                class="col-md-12 pl-zero"
              >
                <div class="wrap-height">
                  <div
                    *ngFor="let selectedPlan of selectedAPlans; let idx = index"
                  >
                    <div
                      class="aPlan-group-text d-flex flex-row justify-content-between"
                    >
                      <button
                        type="button"
                        class="bt remove-aplan"
                        (click)="removeSelectedAPlan(selectedPlan)"
                      >
                        <div class="circle2 minus"></div>
                      </button>
                      <div class="all-title-font aPlan-name">
                        {{ selectedPlan.name }}
                      </div>
                      <span
                        (click)="expandConcept(idx)"
                        class="lists-down-arrow"
                        [ngClass]="{ 'transform-y': !selectedPlan.isExpand }"
                      >
                        <i
                          class="fa fa-angle-down"
                          style="font-size: 25px;color: #007fff;line-height: 1.4"
                        ></i>
                      </span>
                    </div>
                    <div
                      *ngIf="!selectedPlan.isExpand"
                      class="d-flex icons-wrapper"
                    >
                      <div
                        *ngFor="
                          let concept of selectedPlan.concepts;
                          let i = index
                        "
                        class="pr-3"
                      >
                        <img src="/assets/images/thunder-flash-g.png" />
                      </div>
                    </div>
                    <div *ngIf="selectedPlan.isExpand" class="concept-wrapper">
                      <div
                        class="d-flex single-concept"
                        *ngFor="
                          let concept of selectedPlan.concepts;
                          let i = index
                        "
                      >
                        <div>
                          <img src="/assets/images/thunder-flash-g.png" />
                        </div>
                        <div
                          class="concept-name"
                          [ngClass]="{
                            'hide-border':
                              selectedPlan.concepts?.length == i + 1
                          }"
                        >
                          {{ concept.name }}
                        </div>
                      </div>
                    </div>
                    <hr class="hr-style" />
                  </div>
                </div>
              </div>
              <div
                [hidden]="showPlans || selectedAPlans?.length > 0"
                class="display-style col-md-12"
                style="margin-top: 30px;"
              >
                <div class="col-md-6 img-pos">
                  <img src="assets/img/apg-list-default.png" />
                </div>
                <div class="col-md-6">
                  <div class="txt-default">
                    <h3>Add Assessment Plan to this Course Plan</h3>
                  </div>
                  <div class="arrow-pos">
                    <img src="assets/img/arrow.png" />
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="button-wrapper">
            <button
              type="button"
              class="btn sticky-create"
              (click)="continueStep('step7', selectedAPidList)"
            >
              Continue
            </button>
            <div
              [hidden]="!step7"
              class="back-modal"
              (click)="backStep('step7')"
            >
              <i class="fa fa-angle-left"></i>
              <p>Back</p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div *ngIf="step8" class="div_step8">
      <div class="d-flex justify-content-center">
        <div class="inside-data-wrapper pad-100">
          <div class="overlay-wrapper">
            <div class="col-md-12">
              <p class="step-font">Step 8</p>
              <h5 class="all-title-font text-font-align">Optional fields</h5>
            </div>
            <div class="col-md-12" style="padding-top: 40px;">
              <label for="age" class="all-title-font parent-box-name"
                >Age</label
              >
              <div class="display-style">
                <div class="col-md-6" style="padding-left: 0;">
                  <label class="all-title-font"> From </label>
                  <input
                    type="number"
                    placeholder="0 year"
                    class="form-control br-bshadow-none all-left-box-10"
                    (keypress)="numberOnly($event, 'ageFrom')"
                    [(ngModel)]="formField.age.min"
                    (input)="restrictMaxNumberInput($event, maxData, 'age')"
                    min="1"
                    id="age"
                    name="minage"
                    #minData="ngModel"
                  />
                  <div
                    *ngIf="restrictFirstInput"
                    class="alert alert-danger alert-m-right m-top-15"
                  >
                    Must be Lower than "To" Age
                  </div>
                </div>
                <div class="col-md-6" style="padding-right: 0;">
                  <label class="all-title-font" style="padding-left: 20px;">
                    To
                  </label>
                  <input
                    type="number"
                    placeholder="0 year"
                    class="form-control br-bshadow-none all-m-left10"
                    (keypress)="numberOnly($event, 'ageTo')"
                    [(ngModel)]="formField.age.max"
                    min="1"
                    (input)="restrictMinNumberInput($event, minData, 'age')"
                    id="age"
                    name="maxage"
                    #maxData="ngModel"
                  />
                  <div
                    *ngIf="restrictLastInput"
                    class="alert alert-danger alert-m-left m-top-15"
                  >
                    Must be greater than "From" Age
                  </div>
                </div>
              </div>
              <hr class="limit-hr-100" />
            </div>
            <div class="col-md-12" style="padding-top: 40px;">
              <label for="age" class="all-title-font parent-box-name"
                >Payment policy</label
              >
              <div class="display-style">
                <!-- <div class="col-md-4" style="padding: 0;">
									<label class="all-title-font">Deposit</label>
									<select class="form-control br-bshadow-none all-left-box-10" name="deposit" [(ngModel)]="depositModel">
										<option [value]="depositModel" disabled="true">S$ 0</option>
										<option *ngFor="let deposit of depositLists" value="{{deposit._id}}">S$ {{deposit.amount}}</option>
									</select>
									<i class="fa fa-chevron-down down-arrow1"></i>
								</div> -->
                <div class="col-md-6" style="padding: 0;">
                  <label class="all-title-font">Deposit</label>
                  <div>
                    <div
                      class="form-group has-feedback"
                      (click)="depositDropdown()"
                    >
                      <div>
                        <span class="deposit-sign">{{
                          currency.invCurrencySign
                        }}</span>
                        <input
                          class="cursor-on form-control br-bshadow-none all-left-box-10 pad-left-40"
                          name="UserName"
                          type="text"
                          [(ngModel)]="formField.depositAmount"
                          autocomplete="off"
                          readonly
                        /><span class="fa fa-angle-down down-icon"></span>
                      </div>
                    </div>
                    <div class="dropdown-wrap">
                      <ul class="new-dropdown">
                        <li
                          *ngFor="let deposit of depositLists"
                          (click)="chooseDeposit(deposit)"
                        >
                          <span>{{ deposit.amount }}</span>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <label class="all-title-font" style="padding-left: 10px;">
                    Miscellaneous fee
                  </label>
                  <div class="inner-divleft-pad">
                    <label class="sr-only" for="inlineFormInputGroupmisFee"
                      >0</label
                    >
                    <div class="input-group input-group-bg mb-2 mr-sm-2">
                      <div class="input-group-prepend">
                        <div class="input-group-text misfee-bg">
                          {{ currency.invCurrencySign }}
                        </div>
                      </div>
                      <input
                        type="number"
                        class="form-control"
                        id="inlineFormInputGroupmisFee"
                        (click)="toKnowFocus('misFee')"
                        (keypress)="numberOnly($event, 'miscelFee')"
                        placeholder="0"
                        (mouseleave)="leaveHover($event)"
                        (mouseenter)="enterHover($event)"
                        [(ngModel)]="formField.paymentPolicy.miscFee"
                        min="0"
                        name="miscFee"
                        #miscfee="ngModel"
                      />
                    </div>
                  </div>
                </div>
              </div>
              <div class="d-flex">
                <div class="col-md-6 p-0">
                  <div class="display-style">
                    <label class="all-title-font">Prorate class fee</label>
                    <br />
                    <div class="radio-pos-payment">
                      <label class="switch">
                        <input
                          type="checkbox"
                          [(ngModel)]="formField.paymentPolicy.allowProrated"
                          min="0"
                          name="allowProrated"
                          #allow="ngModel"
                        />
                        <span
                          class="slider round"
                          [ngClass]="{
                            activeRadio:
                              formField.paymentPolicy.allowProrated == true
                          }"
                        ></span>
                      </label>
                    </div>
                  </div>
                  <div class="inner-divleft-pad">
                    <!-- <label class="sr-only" for="inlineFormInputGroupmisFee">0</label> -->
                    <div
                      *ngIf="formField.paymentPolicy.allowProrated == true"
                      class="input-group input-group-bg mb-2 mr-sm-2 all-left-box-10"
                    >
                      <div class="input-group-prepend">
                        <div class="input-group-text profee-bg">
                          {{ currency.invCurrencySign }}
                        </div>
                      </div>
                      <input
                        type="number"
                        class="form-control"
                        id="inlineFormInputGroupmisFee"
                        (click)="toKnowFocus('prorateFee')"
                        (keypress)="numberOnly($event, 'prorateFee')"
                        placeholder="0"
                        (mouseleave)="leaveHover($event)"
                        (mouseenter)="enterHover($event)"
                        [(ngModel)]="formField.paymentPolicy.proratedLessonFee"
                        min="0"
                        name="proratedLessonFee"
                        #proratedLessonFee="ngModel"
                      />
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <label class="all-title-font" style="padding-left: 10px;"
                    >Tax Options</label
                  >
                  <div>
                    <div
                      class="form-group has-feedback taxOpt-wrap"
                      (click)="showDropdown('taxOpt', '')"
                      (clickOutside)="closeDropdown($event, 'taxOpt')"
                    >
                      <input
                        class="cursor-on form-control br-bshadow-none"
                        name="taxName"
                        type="text"
                        placeholder="username"
                        [(ngModel)]="chooseTax"
                        placeholder="None"
                        autocomplete="off"
                        readonly
                      /><span class="fa fa-angle-down tax-downicon"></span>
                    </div>
                    <div class="dropdown-wrap" *ngIf="taxOptShow == true">
                      <!-- <div *ngIf="locationMenuShow == false" class="carret"></div> -->
                      <ul class="taxOpt-dropdown">
                        <li (click)="chooseTaxOption('inclusive')">
                          <span>Inclusive</span>
                        </li>
                        <li (click)="chooseTaxOption('exclusive')">
                          <span>Exclusive</span>
                        </li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
              <div class="d-flex">
                <div class="col-md-6" style="padding: 0;">
                  <label class="all-title-font">Invoice Duration</label>
                  <div class="inner-divleft-pad">
                    <input
                      type="number"
                      class="form-control"
                      id="inlineFormInputGroupDuedate"
                      (keypress)="numberOnly($event, 'duedate')"
                      placeholder="0"
                      (mouseleave)="leaveHover($event)"
                      (mouseenter)="enterHover($event)"
                      [(ngModel)]="formField.dueDateCount"
                      min="0"
                      name="invDueDate"
                      #invDueDate="ngModel"
                    />
                  </div>
                </div>
              </div>
              <hr class="limit-hr-100" />
            </div>
            <div class="col-md-12" style="padding-top: 40px;">
              <label for="duration" class="all-title-font parent-box-name"
                >Lesson</label
              >
              <div class="display-style">
                <div class="col-md-6" style="padding: 0;">
                  <label class="all-title-font"> Minimum </label>
                  <div class="inner-div-pad">
                    <input
                      type="number"
                      placeholder="0 lesson"
                      class="form-control br-bshadow-none all-left-box-10"
                      (keypress)="numberOnly($event, 'lessmin')"
                      [(ngModel)]="formField.lesson.min"
                      min="1"
                      (input)="
                        restrictMaxNumberInput($event, maxLesson, 'lesson')
                      "
                      name="minDuration"
                      #minLesson="ngModel"
                    />
                    <div
                      *ngIf="restrictFirstLessInput"
                      class="alert alert-danger alert-m-right m-top-15"
                    >
                      Must be Lower than "Maximum" Lesson
                    </div>
                  </div>
                </div>
                <div class="col-md-6">
                  <label class="all-title-font" style="padding-left: 20px;">
                    Maximum
                  </label>
                  <div class="inner-divleft-pad">
                    <input
                      type="number"
                      placeholder="0 lesson"
                      class="form-control br-bshadow-none all-m-left10"
                      (keypress)="numberOnly($event, 'lessmax')"
                      [(ngModel)]="formField.lesson.max"
                      min="1"
                      (input)="
                        restrictMinNumberInput($event, minLesson, 'lesson')
                      "
                      name="maxDuration"
                      #maxLesson="ngModel"
                    />
                    <div
                      *ngIf="restrictLastLessInput"
                      class="alert alert-danger alert-m-left m-top-15"
                    >
                      Must be greater than "Minimum" Age
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <div class="button-wrapper">
            <button
              *ngIf="isEditCP == false"
              type="submit"
              class="btn sticky-create"
              (click)="createdPlan(parentForm.value, 'create')"
              [disabled]="
                !parentForm.valid ||
                timeInminutes == undefined ||
                timeInminutes == 0
              "
            >
              Create
            </button>
            <button
              *ngIf="isEditCP == true"
              type="submit"
              class="btn sticky-create"
              (click)="createdPlan(parentForm.value, 'update')"
              [disabled]="
                !parentForm.valid ||
                formField.lesson.duration == undefined ||
                formField.lesson.duration == 0
              "
            >
              Update
            </button>
            <div
              [hidden]="!step8"
              class="back-modal"
              (click)="backStep('step8')"
            >
              <i class="fa fa-angle-left"></i>
              <p>Back</p>
            </div>
          </div>
        </div>
      </div>
      <!-- <hr class="limit-hr-100 mr-top-20"> -->
    </div>
  </form>
  <block-ui message="Deafult Message"></block-ui>
</div>
