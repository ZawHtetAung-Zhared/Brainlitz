<app-header *ngIf="!showFormCreate" [ngClass]="{'stick': isSticky == true}"></app-header>
<!-- <div *ngIf="!showFormCreate" class="full-width">
	<div class="sticky-menu" [ngClass]="{'stickywrap' : navIsFixed == true}">
		<div class="display-flex mr-top-menu">
			<div class="col-md-4 pad-0">
				<h3>Customers</h3>
			</div>
			<div class="col-md-8 pad-0">
				<button type="button" class="btn btn-primary create-button-pos" (click)="goCreateForm()">Add new customer</button>
			</div>
		</div>
	</div>
</div>	 -->
<div *ngIf="!showFormCreate && !showCustDetail" class="inner-wrapper" [ngClass]="{'pdactive': isSticky == true}">
	<div class="d-flex mr-top-menu">
		<div class="col-md-4 pad-0">
			<h3>Customers</h3>
		</div>
		<div class="col-md-8 pad-0">
			<button type="button" class="btn btn-primary create-button-pos" (click)="goCreateForm()">Add new customer</button>
		</div>
	</div>
	<div class="col-md-12 pad-0" style="margin-top: 35px;">
		<div class="input-group col-md-12 pad-0">
		    <input class="form-control py-2 input-search-bg" type="search" placeholder="Search customer here" id="example-search-input">
		    <span class="input-group-append">
		        <button class="bt btn-design btn-outline-secondary" type="button">
		            <i class="fa fa-search search-size"></i>
		        </button>
		     </span>
		</div>
	</div>
	<div class="row display-flex">
		<div class="col-xs-12 col-sm-6 col-md-6 col-lg-6 col-xl-4 mr-box display-block" *ngFor="let customer of customerLists; let i = index">
			<div class="box-design d-flex" (click)="showDetails(customer, customer.userId)">
				<div class="profileimg-wrap">
					<div class="circular-image">
						<img src="{{customer.profilePic}}">
					</div>
				</div>
				<div class="info-side">
					<h5 style="margin-bottom: 0.3rem">{{customer.preferredName}}</h5>
					<p class="info-mail" style="margin-bottom: 0.8rem">{{customer.email}}</p>
					<p class="info-about">Owns Guitar & Piano</p>
				</div>
				<div class="right-arrow">
					<i class="fa fa-angle-right"></i>
				</div>
			</div>
		</div>
	</div>
</div>

<div *ngIf="showCustDetail" class="content-wrapper" [ngClass]="{'pdactive': isSticky == true}">
	<div class="main-wrapper">
		<div class="d-flex heading-space">
			<div class="back" (click)="backToCustomer()">
				<i class="fa fa-angle-left" style="color: #3d5266;font-size: 20px;"></i><span>Customers</span>
			</div>
			<div class="ml-auto">
				<span class="back" (click)="getSingleInfo(editId)">Edit Profile</span>
			</div>
		</div>
		<div class="d-flex cust-info-wrapper">
			<div class="img-wrap">
				<div class="circular-image">
					<img src="custDetail.user.profilePic">
				</div>
			</div>
			<div class="d-flex justify-content-center info-wrap">
				<div class="info-col">
					<div class="infoGp-wrap">
					<!-- <p>{{custDetail.user.profilePic}}</p> -->
						<h5>{{custDetail.user.preferredName}}</h5>
						<p class="info-mail">{{custDetail.user.email}}</p>
					</div>
					<div class="infoGp-wrap">
						<label class="info-mail">Gurdians</label>
						<div class="d-flex">
							<div class="d-flex gurdian-wrap" *ngFor="let gurdian of custDetail.user.guardians">
								<div class="small-circular-image"><img src="{{gurdian.profilePic}}"></div>
								<div class="d-flex justify-content-center flex-column info-p padL-5">
									{{ (gurdian.fullname == null )? ("") : (gurdian.fullname) }}
								</div>
							</div>
						</div>
					</div>
				</div>
				<div class="info-col">
					<div class="infoGp-wrap">
						<label class="info-mail">Full name</label>
						<p class="mb-0 info-p">{{ custDetail.user.fullname }}</p>
					</div>
					<div class="d-flex infoGp-wrap info-wrap">
						<div class="timetable-col">
							<label class="info-mail">Date of birth</label>
							<p class="mb-0 info-p">9 June 1996</p>
						</div>
						<div class="timetable-col">
							<label class="info-mail">Height</label>
							<p class="mb-0 info-p">5' 10"</p>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="btn-wrap">
			<div></div>
		</div>
		<div>
			<div class="d-flex title-space">
				<div class="d-flex flex-column justify-content-center">
					<h6 class="mb-0">Classes</h6>
				</div>
				<button class="ml-auto enroll-btn">Enroll new class</button>
			</div>
			<div>
				<div class="list-wrapper">
					<div class="child" *ngFor="let course of custDetail.courses| slice:0:showCourse">
						<label class="class-label-12"><i class="fa fa-map-marker" style="font-size:12px;padding-right: 4px"></i>{{ course.location.name }}</label>
						<p class="info-p">{{ course.name }}</p>
						<div class="d-flex info-wrap">
							<div class="timetable-col">
								<label class="class-label-14 mb-0" *ngFor="let day of course.repeatDays | weekDays">{{ day }}</label>
								<p class="medium-label-14 mb-0">10:00am - 11:00am</p>
							</div>
							<div class="d-flex timetable-col day-wrap info-wrap">
								<div class="timetable-col">
									<label class="medium-label-14 mb-0">From</label>
									<p class="class-label-14 mb-0">{{ course.startDate | date }}</p>
								</div>
								<div class="timetable-col">
									<label class="medium-label-14 mb-0">To</label>
									<p *ngIf = "course.endDate" class="class-label-14 mb-0">{{ course.endDate | date }}</p>
								</div>
							</div>
						</div>
					</div>
				</div>
			</div>
			<div class="btn-wrap">
				<button *ngIf="showCourse<custDetail.courses?.length" class="btn-showmore pad-0" (click)="showMoreItem('course')"><span>Show More</span><i class="fa fa-angle-down" aria-hidden="true"></i></button>
				<div></div>
			</div>
		</div>
		<div class="d-flex">
			<div class="firstCol">
				<div *ngFor="let widget of custDetail.widgets">
					<h6 class="title-space">{{ widget.name }}</h6>
					<div>
						<div class="list-wrapper">
							<div *ngFor="let apg of widget.APG|slice:0:[widget.name == 'Progress' ? showProgress: showBadge]">
								<div>
									<div class="child">
										<label class="info-p">{{ apg.name }}</label>
										<div *ngFor="let accessPoint of apg.accessPoints">
											<div class="bar-wrapper">
												<ngb-progressbar [value]="accessPoint.score" height="0.3rem"></ngb-progressbar>
											</div>
											<span class="class-label-12">{{ accessPoint.score }}% accomplished</span>
										</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="btn-wrap">
						<button *ngIf="widget.name == 'Progress' && showProgress< widget.APG.length" class="btn-showmore pad-0" (click)="showMoreItem(widget.name)"><span>Show More P</span><i class="fa fa-angle-down" aria-hidden="true"></i></button>
						<button *ngIf="widget.name == 'Badge' && showBadge< widget.APG.length" class="btn-showmore pad-0" (click)="showMoreItem(widget.name)"><span>Show More B</span><i class="fa fa-angle-down" aria-hidden="true"></i></button>
						<div></div>
					</div>
				</div>
				<div>
					<h6 class="title-space">Ratings and reviews</h6>
					<div>
						<div class="card-columns">
							<div *ngFor="let rating of custDetail.ratings| slice:0:showRating" class="card card-wrap">
								<div class="d-flex">
									<star-rating-comp class="custDetail-rating" [readOnly]="true" [starType]="'svg'" [rating]="rating.rating"></star-rating-comp>
									<span class="ml-auto medium-label-12">{{ rating.updatedDate | date }}</span>
								</div>
								<p class="medium-label-14" style="color: #2e3d4d"><read-more class="cust-readmore" [text]="rating.message"></read-more></p>
								<div class="d-flex info-wrap">
									<div class="timetable-col d-flex">
										<div class="small-circular-image">
											<img src="{{ rating.teacher_info.profilePic }}">
										</div>
										<div class="padL-5">
											<label class="medium-label-12 mb-0">Teacher</label>
											<p class="teacher-label-12 mb-0">{{ rating.teacher_info.preferredName }}</p>
										</div>
									</div>
									<div class="timetable-col course-wrap info-wrap">
										<label class="medium-label-12 mb-0">Course</label>
										<p class="teacher-label-12 mb-0">{{ rating.course_info.name }}</p>
									</div>
								</div>
							</div>
						</div>
					</div>
					<div class="btn-wrap">
						<button *ngIf="showRating<custDetail.ratings?.length" class="btn-showmore pad-0" (click)="showMoreItem('rating')"><span>Show More</span><i class="fa fa-angle-down" aria-hidden="true"></i></button>
					</div>
				</div>
			</div>
			<div class="secondCol">
				<div class="inner-secondCol">
					<h6 >Activity</h6>
					<div>
						<div class="activity-wrapper" *ngFor="let activity of custDetail.journals| slice: 0:showActivity">
							<div class="d-flex">
								<div class="teacher-label-12" style="width: 100%">{{ activity.message }}</div>
								<div class="icon-img">
									
								</div>
							</div>
							<label class="medium-label-12 mb-0">{{ activity.time }}</label>
						</div>
						<!-- <div *ngIf="seeAll">
							<div *ngFor="let activity of testActivities; let idx= index;">
								<div *ngIf="idx >= 4" class="activity-wrapper">
									<div class="d-flex">
										<div class="teacher-label-12" style="width: 100%">{{ activity.activity }}</div>
										<div class="icon-img">
											
										</div>
									</div>
									<label class="medium-label-12 mb-0">{{ activity.time }}</label>
								</div>
							</div>
						</div> -->
						<div>
							<button *ngIf="showActivity<custDetail.journals?.length" class="btn-showmore pad-0" style="font-size: 14px" (click)="showMoreItem('activity')"><span>See all activities</span><i class="fa fa-angle-right" aria-hidden="true"></i></button>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>

<div *ngIf="showFormCreate" class="sticky-back-user" [ngClass]="{'sticky-bar' : isCreateFix == true}">
	<button type="button" class="back-button display-flex" (click)="backToCustomer()">
		<i class="fa fa-angle-left left-arrow"></i> <p class="back-staff-txt fl-txt-rt">Customers</p>
	</button>
</div>

<div class="inner-wrapper-detail" *ngIf="showFormCreate">
	<button type="button" class="back-button display-flex" (click)="backToCustomer()">
		<i class="fa fa-angle-left left-arrow"></i> <p class="back-staff-txt fl-txt-rt">Customers</p>
	</button>
	<div class="col-md-12 pad-0 mr-bt-top">
		<h3>Create Customers account</h3>
	</div>
	<form class="form-wrap" novalidate #f="ngForm">
		<div class="row display-flex">
			<div class="col-md-7 pad-bottom">
				<div class="form-group form-divider">
					<div class="d-flex justify-content-between">
						<label for="prename" class="label-txt">What should we call you? <br> <span>e.g. How your call you or like your preferred name</span></label> 
						<div class="limit-wordcount">
							<span>{{wordLength}}/60characters</span>
						</div>
					</div>	
		  	    	<input type="text" class="form-control " placeholder="Type preferred name here" name="preferredName" [(ngModel)]="formFieldc.preferredName" #preferredName="ngModel" (focus)="focusMethod($event)" (blur)="blurMethod($event)" (input)="changeMethod($event.target.value)" maxlength="60" required>
		  	    	<div *ngIf="preferredName.invalid && (preferredName.dirty || preferredName.touched)" class="alert alert-danger">
				        <div [hidden]="!preferredName.errors.required">
				          Display name is required!
				        </div>
				    </div>
		  	  	</div>
		  	  	<div class="form-group form-divider">
		  	    	<label for="firstName" class="label-txt">First name</label> 	
		  	    	<input type="text" class="form-control" placeholder="Type first name here" name="firstName" [(ngModel)]="formFieldc.firstName" #firstName="ngModel" required>
		  	    	<div *ngIf="firstName.errors && (firstName.dirty || firstName.touched)" class="alert alert-danger">
				        <div [hidden]="!firstName.errors.required">
				          First name is required!
				        </div>
				    </div>
		  	  	</div>
		  	  	<div class="form-group form-divider">
		  	    	<label for="lastName" class="label-txt">Last name</label> 	
		  	    	<input type="text" class="form-control" placeholder="Type last name here" name="lastName" [(ngModel)]="formFieldc.lastName" #lastName="ngModel" required>
		  	    	<div *ngIf="lastName.errors && (lastName.dirty || lastName.touched)" class="alert alert-danger">
				        <div [hidden]="!lastName.errors.required">
				          Last name is required!
				        </div>
				    </div>
		  	  	</div>
		  	  	<div class="form-group form-divider">
		  	    	<label for="email" class="label-txt">Email address</label> 	
		  	    	<input type="email" class="form-control" placeholder="Type email address here" (keyup)="validateEmail(formFieldc.email)"  name="email" [(ngModel)]="formFieldc.email" #email="ngModel">
		  	    	<div *ngIf="emailAlert" class="alert alert-danger">
		  	    		Please provide a valid email
		  	    	</div>
		  	  	</div>
		  	  	<div *ngIf="isupdate == false" class="form-group form-divider">
		  	    	<label for="password" class="label-txt">Password</label> 	
		  	    	<input type="password" class="form-control" placeholder="Type password here" name="password" [(ngModel)]="formFieldc.password" #password="ngModel" required>
		  	    	<div *ngIf="password.errors && (password.dirty || password.touched)" class="alert alert-danger">
				        <div [hidden]="!password.errors.required">
				          Password is required!
				        </div>
				    </div>
		  	  	</div>
		  	  	<div class="form-group form-divider">
		  	    	<label for="guardmail" class="label-txt">Guardian email</label> 	
		  	    	<input type="email" class="form-control" placeholder="Type guardian email here" name="gurdianMail" [(ngModel)]="formFieldc.guardianmail" (keyup)="validateGuarmail(formFieldc.guardianmail)"
		  	    	#gurdianMail="ngModel">
		  	    	<div *ngIf="guardianAlert" class="alert alert-danger">
		  	    		Please provide a valid email!
		  	    	</div>
		  	  	</div>
			</div>
			<div class="col-md-5">
				<label for="upload">
					<div *ngIf="!imgDemoSlider" class="profile-box label-txt">
						<div class="form-group">
							<label for="upload" class="profile-label">Profile</label><br>
							<div class="circular-profile">
								<img *ngIf="isupdate == false" src="assets/img/user.svg">
								<img *ngIf="isupdate == true" src="{{returnProfile}}">
							</div>	
							<div class="demo-wrap upload-demo">
					          	<div class="container">
						            <div class="grid">
					              	<div class="col-1-2">
					                	<div class="actions">
					                		<a class="btn file-btn">
					                  		<input 
					                  			type="file" 
					                  			class="upload-jpg form-control" 
					                  			id="upload" 
					                  			#cropper 
					                  			(change)='uploadCropImg($event)'
					                  			value="Choose a file" 
					                  			accept="image/*" 
					                  			style="display:none" />
					                		</a>
					                	</div>
					              	</div>
						            </div>
					       		</div>
						    </div>
						    <p>Update photo</p>						
						</div>
					</div>
				</label>
				<div class="frame-upload">
					<div class="upload-demo-wrap">
		              	<div id="upload-demo"></div>
		            </div>
		            <div class="row mr-button">
		            	<div class="col-md-6 crop-box" style="border-bottom-left-radius: 10px;">
			            	<div class="br-right">
			            		<button *ngIf="blankCrop" class="upload-result btn1" (click)="backToUpload()">Cancel</button>
			            	</div>
			            </div>
		            	<div class="col-md-6 crop-box" style="border-bottom-right-radius: 10px;">
			            	<button *ngIf="blankCrop" class="upload-result btn2" id="sizeDisable" (click)="cropResult()" [value]="blankCrop">Crop</button>
			            </div>
		            </div>
				</div>
				<div class="button-group">
					<button type="button" class="bt cancel-button" (click)="back()" >Cancel</button>
		        	<button *ngIf="isupdate == false" type="submit" (click)="createUser(formFieldc, 'create')" class="btn create-button" [disabled]="!f.form.valid">Create
					</button>
					<button *ngIf="isupdate == true" type="submit" (click)="createUser(formFieldc, 'edit')" class="btn create-button" [disabled]="!f.form.valid">Update
					</button>
				</div>
			</div>
		</div>
	</form>
</div>


<block-ui message="Deafult Message"></block-ui> 